<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eco-Tourist</title>
    <link rel="stylesheet" href="style.css">
    <script src="functions.js" defer></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBLw4sft_50tOYHYa109TPHqPsV8Tftf58"></script>
    <script>
        function initMap() {
            // Map options
            var options = {
                zoom: 6,
                center: { lat: 36.2048, lng: 138.2529 } // Centered on Japan
            };

            // New map
            var map = new google.maps.Map(document.getElementById("map"), options);

            // Locations with coordinates
            var locations = [
                { name: "埼玉県 飯能市", lat: 35.8579, lng: 139.3216 },
                { name: "渡嘉敷村", lat: 26.1978, lng: 127.3654 },
                { name: "座間味村", lat: 26.2292, lng: 127.3099 },
                { name: "谷川岳", lat: 36.8177, lng: 139.0236 },
                { name: "三重県 鳥羽市", lat: 34.4875, lng: 136.8431 },
                { name: "三重県 名張市", lat: 34.6286, lng: 136.1031 },
                { name: "京都府 南丹市美山", lat: 35.2392, lng: 135.6716 },
                { name: "小笠原", lat: 27.0935, lng: 142.2132 },
                { name: "北海道弟子屈町", lat: 43.4825, lng: 144.4587 },
                { name: "上市まちのわ", lat: 36.7056, lng: 137.3239 },
                { name: "石鎚山系", lat: 33.7623, lng: 133.1184 },
                { name: "串間", lat: 31.4722, lng: 131.2271 },
                { name: "奄美市", lat: 28.3762, lng: 129.4947 },
                { name: "東京都 檜原村", lat: 35.7288, lng: 139.0848 },
                { name: "岐阜県 下呂市", lat: 35.8052, lng: 137.2446 },
                { name: "赤城山", lat: 36.5293, lng: 139.2028 },
                { name: "熊本県 阿蘇ジオパーク", lat: 32.8833, lng: 131.1042 },
                { name: "吉野川紀の川源流", lat: 33.8484, lng: 135.8639 },
                { name: "宮島", lat: 34.2958, lng: 132.3198 },
                { name: "岐阜県 白川村", lat: 36.2606, lng: 136.8997 },
                { name: "長野県 軽井沢町", lat: 36.3483, lng: 138.5915 },
                { name: "群馬県 みなかみ町", lat: 36.6786, lng: 138.9842 },
                { name: "沖縄県 西表島", lat: 24.3161, lng: 123.8444 },
                { name: "滋賀県 東近江市", lat: 35.1094, lng: 136.1815 },
                { name: "青森県 奥入瀬渓流", lat: 40.5230, lng: 140.9738 },
                { name: "群馬県 前橋市", lat: 36.3896, lng: 139.0622 },
                { name: "奈良県 川上村", lat: 34.2572, lng: 135.9634 },
                { name: "愛媛県 西条市", lat: 33.9170, lng: 133.1826 },
                { name: "鹿児島県 屋久島町", lat: 30.3718, lng: 130.6517 },
                { name: "鹿児島県 甑島", lat: 31.8114, lng: 129.8700 },
                { name: "香川県 まんのう町", lat: 34.1419, lng: 133.9630 },
                { name: "東京都 神津島", lat: 34.1967, lng: 139.1450 },
                { name: "富山県 上市町", lat: 36.7056, lng: 137.3239 },
                { name: "広島県 廿日市市",lat: 34.3482, lng: 132.3316 }
                
            ];

            // Add markers with info windows
            locations.forEach(function(location) {
                var marker = new google.maps.Marker({
                    position: { lat: location.lat, lng: location.lng },
                    map: map,
                    title: location.name
                });

                var infoWindow = new google.maps.InfoWindow({
                    content: `<div style="font-size:14px;"><b>${location.name}</b></div>`
                });

                // Show info window on marker click
                marker.addListener("click", function() {
                    infoWindow.open(map, marker);
                });
            });
        }
    </script>
</head>
<body onload="initMap()">
    <header>
        <div class="title">
            <h1>Eco-Tourist</h1>
            <p>楽に自然を探索しろ</p>
        </div>
    </header>
        <section class="search-section">
            <h2>動物の生息地を検索</h2>
            <input type="text" id="animalSearchInput" placeholder="動物の名前を入力 (例: ツキノワグマ)">
            <button onclick="searchHabitat()">検索</button>
            <p id="searchResult"></p>
        </section>
        <section class="cards" style="display: flex; justify-content: center; align-items: flex-start; flex-wrap: wrap;"></section>
        <section id="map-section">
            <h2>Explore Locations</h2>
            <div id="map" style="width: 100vw; height: 600px;"></div>
        </section>
    </main>

    <nav class="navbar">
        <button onclick="window.location.href='index.html'">ホーム</button>
        <button onclick="goToEncyclopedia()">生物調査</button>
        <button onclick="window.location.href='gallery.html'">生物図鑑</button>
    </nav>

    <script>
        let videoStream = null;

// Function to start the camera
function startCamera() {
    const video = document.getElementById('cameraFeed');
    video.style.display = 'block';

    navigator.mediaDevices.getUserMedia({ video: { facingMode: { exact: "environment" } } })
        .then((stream) => {
            videoStream = stream;
            video.srcObject = stream;
        })
        .catch((error) => {
            console.error('Error accessing camera:', error);
            alert('カメラにアクセスできませんでした。カメラの設定を確認してください。');
        });
}

// Function to take a photo and save it
function takePhoto() {
    const video = document.getElementById('cameraFeed');
    const canvas = document.createElement('canvas');
    const context = canvas.getContext('2d');

    // Set canvas size to match video
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;

    // Draw the current video frame onto the canvas
    context.drawImage(video, 0, 0, canvas.width, canvas.height);

    // Convert canvas to image URL
    const photoURL = canvas.toDataURL('image/jpeg');

    // Save the photo URL to localStorage
    let storedPhotos = JSON.parse(localStorage.getItem('photos')) || [];
    storedPhotos.push(photoURL);
    localStorage.setItem('photos', JSON.stringify(storedPhotos));

    // Notify the user
    alert('写真が保存されました！');
}

        // Function to start the camera
        function startCamera() {
            const video = document.getElementById('cameraFeed');
            video.style.display = 'block';

            // Access the user's camera
            navigator.mediaDevices.getUserMedia({ video: { facingMode: { exact: "environment" } } })
                .then((stream) => {
                    video.srcObject = stream;
                })
                .catch((error) => {
                    console.error('Error accessing camera:', error);
                    alert('カメラにアクセスできませんでした。カメラの設定を確認してください。');
                });
        }

        // Function to navigate to the encyclopedia page
        function goToEncyclopedia() {
            window.location.href = 'creature.html';
        }
    </script>
</body>
</html>
