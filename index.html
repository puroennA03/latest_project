<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eco-Tourist</title>
    <link rel="stylesheet" href="style.css">
    <script src="functions.js" defer></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBLw4sft_50tOYHYa109TPHqPsV8Tftf58"></script>
    <script>
        function initMap() {
            // Map options
            var options = {
                zoom: 6,
                center: { lat: 36.2048, lng: 138.2529 } // Centered on Japan
            };

            // New map
            var map = new google.maps.Map(document.getElementById("map"), options);

            // Locations with coordinates
            var locations = [
                { name: "åŸ¼ç‰çœŒ é£¯èƒ½å¸‚", lat: 35.8579, lng: 139.3216 },
                { name: "æ¸¡å˜‰æ•·æ‘", lat: 26.1978, lng: 127.3654 },
                { name: "åº§é–“å‘³æ‘", lat: 26.2292, lng: 127.3099 },
                { name: "è°·å·å²³", lat: 36.8177, lng: 139.0236 },
                { name: "ä¸‰é‡çœŒ é³¥ç¾½å¸‚", lat: 34.4875, lng: 136.8431 },
                { name: "ä¸‰é‡çœŒ åå¼µå¸‚", lat: 34.6286, lng: 136.1031 },
                { name: "äº¬éƒ½åºœ å—ä¸¹å¸‚ç¾å±±", lat: 35.2392, lng: 135.6716 },
                { name: "å°ç¬ åŸ", lat: 27.0935, lng: 142.2132 },
                { name: "åŒ—æµ·é“å¼Ÿå­å±ˆç”º", lat: 43.4825, lng: 144.4587 },
                { name: "ä¸Šå¸‚ã¾ã¡ã®ã‚", lat: 36.7056, lng: 137.3239 },
                { name: "çŸ³éšå±±ç³»", lat: 33.7623, lng: 133.1184 },
                { name: "ä¸²é–“", lat: 31.4722, lng: 131.2271 },
                { name: "å¥„ç¾å¸‚", lat: 28.3762, lng: 129.4947 },
                { name: "æ±äº¬éƒ½ æªœåŸæ‘", lat: 35.7288, lng: 139.0848 },
                { name: "å²é˜œçœŒ ä¸‹å‘‚å¸‚", lat: 35.8052, lng: 137.2446 },
                { name: "èµ¤åŸå±±", lat: 36.5293, lng: 139.2028 },
                { name: "ç†Šæœ¬çœŒ é˜¿è˜‡ã‚¸ã‚ªãƒ‘ãƒ¼ã‚¯", lat: 32.8833, lng: 131.1042 },
                { name: "å‰é‡å·ç´€ã®å·æºæµ", lat: 33.8484, lng: 135.8639 },
                { name: "å®®å³¶", lat: 34.2958, lng: 132.3198 },
                { name: "å²é˜œçœŒ ç™½å·æ‘", lat: 36.2606, lng: 136.8997 },
                { name: "é•·é‡çœŒ è»½äº•æ²¢ç”º", lat: 36.3483, lng: 138.5915 },
                { name: "ç¾¤é¦¬çœŒ ã¿ãªã‹ã¿ç”º", lat: 36.6786, lng: 138.9842 },
                { name: "æ²–ç¸„çœŒ è¥¿è¡¨å³¶", lat: 24.3161, lng: 123.8444 },
                { name: "æ»‹è³€çœŒ æ±è¿‘æ±Ÿå¸‚", lat: 35.1094, lng: 136.1815 },
                { name: "é’æ£®çœŒ å¥¥å…¥ç€¬æ¸“æµ", lat: 40.5230, lng: 140.9738 },
                { name: "ç¾¤é¦¬çœŒ å‰æ©‹å¸‚", lat: 36.3896, lng: 139.0622 },
                { name: "å¥ˆè‰¯çœŒ å·ä¸Šæ‘", lat: 34.2572, lng: 135.9634 },
                { name: "æ„›åª›çœŒ è¥¿æ¡å¸‚", lat: 33.9170, lng: 133.1826 },
                { name: "é¹¿å…å³¶çœŒ å±‹ä¹…å³¶ç”º", lat: 30.3718, lng: 130.6517 },
                { name: "é¹¿å…å³¶çœŒ ç”‘å³¶", lat: 31.8114, lng: 129.8700 },
                { name: "é¦™å·çœŒ ã¾ã‚“ã®ã†ç”º", lat: 34.1419, lng: 133.9630 },
                { name: "æ±äº¬éƒ½ ç¥æ´¥å³¶", lat: 34.1967, lng: 139.1450 },
                { name: "å¯Œå±±çœŒ ä¸Šå¸‚ç”º", lat: 36.7056, lng: 137.3239 },
                { name: "åºƒå³¶çœŒ å»¿æ—¥å¸‚å¸‚",lat: 34.3482, lng: 132.3316 }
                
            ];

            // Add markers with info windows
            locations.forEach(function(location) {
                var marker = new google.maps.Marker({
                    position: { lat: location.lat, lng: location.lng },
                    map: map,
                    title: location.name
                });

                var infoWindow = new google.maps.InfoWindow({
                    content: `<div style="font-size:14px;"><b>${location.name}</b></div>`
                });

                // Show info window on marker click
                marker.addListener("click", function() {
                    infoWindow.open(map, marker);
                });
            });
        }
    </script>
</head>
<body onload="initMap()">
    <header>
        <div class="title">
            <h1>Eco-Tourist</h1>
            <p>æ¥½ã«è‡ªç„¶ã‚’æ¢ç´¢ã—ã‚</p>
        </div>
    </header>

    <main>
        <section class="cards">
            <div class="card">
                <button class="card-btn" onclick="startCamera()">æ’®å½±</button>
                <p>é‡ç”Ÿã®ç”Ÿãç‰©ã®å†™çœŸã‚’æ’®ã‚Šã¾ã—ã‚‡ã†ï¼</p>
                <!-- Video element to show camera feed -->
                <video id="cameraFeed" autoplay playsinline style="display: none; width: 100%; border-radius: 8px;"></video>
            </div>
            <div class="camera-controls">
                <button onclick="takePhoto()">ğŸ“¸ æ’®å½±ã™ã‚‹</button>
                <canvas id="photoCanvas" style="display: none; width: 100%; border-radius: 8px;"></canvas>
            </div>
            
            <div class="card">
                <button class="card-btn" onclick="goToEncyclopedia()">ç”Ÿç‰©èª¿æŸ»</button>
                <p>è‡ªç„¶ã®ä¸­ã§ã®ç™ºè¦‹ï¼è‡ªåˆ†ã ã‘ã®ç™ºè¦‹ã‚’æŒã¡å¸°ã‚ã†ï¼</p>
            </div>
        </section>
    </main>
        <section class="search-section">
            <h2>å‹•ç‰©ã®ç”Ÿæ¯åœ°ã‚’æ¤œç´¢</h2>
            <input type="text" id="animalSearchInput" placeholder="å‹•ç‰©ã®åå‰ã‚’å…¥åŠ› (ä¾‹: ãƒ„ã‚­ãƒãƒ¯ã‚°ãƒ)">
            <button onclick="searchHabitat()">æ¤œç´¢</button>
            <p id="searchResult"></p>
        </section>
        <section class="cards" style="display: flex; justify-content: center; align-items: flex-start; flex-wrap: wrap;"></section>
        <section id="map-section">
            <h2>Explore Locations</h2>
            <div id="map" style="width: 100vw; height: 600px;"></div>
        </section>
    </main>

    <nav class="navbar">
        <button onclick="window.location.href='index.html'">ãƒ›ãƒ¼ãƒ </button>
        <button onclick="goToEncyclopedia()">ç”Ÿç‰©èª¿æŸ»</button>
        <button onclick="window.location.href='gallery.html'">ç”Ÿç‰©å›³é‘‘</button>
        <button onclick="window.location.href='test.html'">ç”Ÿç‰©å›³é‘‘</button>
        <button>ã‚¯ã‚¤ã‚º</button>
    </nav>

    <script>
        let videoStream = null;

// Function to start the camera
function startCamera() {
    const video = document.getElementById('cameraFeed');
    video.style.display = 'block';

    navigator.mediaDevices.getUserMedia({ video: { facingMode: { exact: "environment" } } })
        .then((stream) => {
            videoStream = stream;
            video.srcObject = stream;
        })
        .catch((error) => {
            console.error('Error accessing camera:', error);
            alert('ã‚«ãƒ¡ãƒ©ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚ã‚«ãƒ¡ãƒ©ã®è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
        });
}

// Function to take a photo and save it
function takePhoto() {
    const video = document.getElementById('cameraFeed');
    const canvas = document.createElement('canvas');
    const context = canvas.getContext('2d');

    // Set canvas size to match video
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;

    // Draw the current video frame onto the canvas
    context.drawImage(video, 0, 0, canvas.width, canvas.height);

    // Convert canvas to image URL
    const photoURL = canvas.toDataURL('image/jpeg');

    // Save the photo URL to localStorage
    let storedPhotos = JSON.parse(localStorage.getItem('photos')) || [];
    storedPhotos.push(photoURL);
    localStorage.setItem('photos', JSON.stringify(storedPhotos));

    // Notify the user
    alert('å†™çœŸãŒä¿å­˜ã•ã‚Œã¾ã—ãŸï¼');
}

        // Function to start the camera
        function startCamera() {
            const video = document.getElementById('cameraFeed');
            video.style.display = 'block';

            // Access the user's camera
            navigator.mediaDevices.getUserMedia({ video: { facingMode: { exact: "environment" } } })
                .then((stream) => {
                    video.srcObject = stream;
                })
                .catch((error) => {
                    console.error('Error accessing camera:', error);
                    alert('ã‚«ãƒ¡ãƒ©ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚ã‚«ãƒ¡ãƒ©ã®è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
                });
        }

        // Function to navigate to the encyclopedia page
        function goToEncyclopedia() {
            window.location.href = 'creature.html';
        }
    </script>
</body>
</html>
